# Cost Optimization Configuration
# Budget Cap: $50/month (GCP only)
# ZL-Only: MES removed, ZL primary focus

optimization:
  budget_cap_usd: 50
  alert_threshold_percent: 80  # Alert at $40/month
  zl_only: true  # ZL-only mode (MES removed)
  
  bigquery:
    # Query optimizations
    max_query_date_range_days: 30  # Only query last 30 days by default
    enable_query_cache: true
    cache_ttl_hours: 24
    max_concurrent_queries: 5
    
    # Storage optimizations
    archive_after_days: 90  # Move to long-term storage after 90 days
    delete_raw_after_days: 730  # Delete raw data after 2 years
    compression: "snappy"  # Parquet compression
    
    # Materialized views
    enable_materialized_views: true
    refresh_interval_minutes: 5
    
  databento:
    # ZL-only: 1 hour for price, 4 hours for all else
    zl_pull_interval_hours: 1  # ZL price: Every hour
    other_pull_interval_hours: 4  # Other symbols: Every 4 hours
    zl_upload_interval_hours: 1  # Upload ZL hourly
    other_upload_interval_hours: 4  # Upload others every 4 hours
    enable_local_cache: true
    cache_path: "/Volumes/Satechi Hub/Projects/CBI-V15/cache/databento"
    deduplicate: true
    symbols:
      primary: [ZL]  # ZL only - primary focus
      secondary: [ZS, ZM, CL, HO, FCPO]  # Pulled every 4 hours
    
  public_datasets:
    # Reduce query frequency
    query_frequency: "weekly"  # Query weekly, cache results
    max_date_range_days: 30
    cache_in_staging: true
    
  dataform:
    # Incremental runs only
    run_frequency: "daily"
    use_incremental: true
    full_refresh_frequency: "weekly"  # Full refresh only weekly
    
  dashboard:
    # Aggressive caching
    cache_ttl_minutes: 5
    max_date_range_days: 30
    use_materialized_views: true
    pagination_limit: 1000
    
  storage:
    # Cloud Storage optimization
    use_nearline: true  # Use Nearline for archives
    compress_before_upload: true
    delete_after_days: 90  # Auto-delete files >90 days
    
monitoring:
  # Cost monitoring
  daily_cost_report: true
  weekly_storage_audit: true
  monthly_optimization_review: true
  
  # Alerts
  budget_alert_email: "your-email@example.com"
  query_cost_alert_threshold_gb: 100  # Alert if single query >100 GB
  
  # Reports
  cost_report_frequency: "daily"
  storage_report_frequency: "weekly"

